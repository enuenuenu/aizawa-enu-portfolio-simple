<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <title>藍沢えぬ ポートフォリオ</title>
  <link rel="stylesheet" href="style.css">
  <style>
    /* 3D表示用の領域 */
    #model-viewer {
      width: 100%;
      height: 500px;
      background: linear-gradient(45deg, #1a1a2e, #16213e);
      margin-bottom: 2rem;
      border-radius: 10px;
      position: relative;
      overflow: hidden;
    }

    .model-section {
      padding: 2rem;
      text-align: center;
    }

    .profile {
      padding: 2rem;
      text-align: center;
    }

    .profile-link {
      text-decoration: none;
      color: inherit;
    }

    .profile-content {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 1rem;
      padding: 1rem;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
    }

    .icon {
      width: 80px;
      height: 80px;
      border-radius: 50%;
    }

    .welcome {
      padding: 2rem;
      text-align: center;
    }

    .video-section {
      padding: 2rem;
      text-align: center;
    }

    .video-embed {
      max-width: 560px;
      margin: 0 auto;
    }

    .video-embed iframe {
      width: 100%;
      height: 315px;
    }

    body {
      font-family: Arial, sans-serif;
      background: #0a0a0a;
      color: white;
      margin: 0;
      padding: 0;
      padding-bottom: 200px; 
    }

    .loading-text {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 18px;
      color: #fff;
      z-index: 10;
    }

    .error-text {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 16px;
      color: #ff6b6b;
      text-align: center;
      z-index: 10;
    }
  </style>
</head>

<body>
  <div class="cyber-bg"></div>
  <main>
    <section class="profile">
      <h2>プロフィール</h2>
      <a href="profile.html" class="profile-link">
        <div class="profile-content">
          <img class="icon" src="img/icon.png" alt="藍沢えぬ アイコン">
          <div class="profile-text">
            <p>AI系Vtuber、藍沢えぬです！<br>よろしくお願いします。</p>
            <div class="links">
              <a href="https://x.com/N_AIzawa_" class="x-link" target="_blank" onclick="event.stopPropagation();">X</a>
              <a href="https://www.youtube.com/channel/UC66m5psoC9u4QkeOkM2tY0g" class="yt-link" target="_blank"
                onclick="event.stopPropagation();">YouTube</a>
            </div>
          </div>
        </div>
      </a>
    </section>
    <section class="welcome">
      <h1>ようこそ！</h1>
      <p>藍沢えぬのポートフォリオへ</p>
    </section>
    <section class="video-section">
      <h2>最新動画</h2>
      <div class="video-embed">
        <iframe width="560" height="315" src="https://www.youtube.com/embed/H7CCIPx3XgQ" title="YouTube video"
          frameborder="0" allowfullscreen></iframe>
      </div>
    </section>
    <section class="works">
      <h2>コンテンツ</h2>
      <div class="card-list">
        <div class="work-card" onclick="location.href='character-videos.html'">
          <h3>部位別の動画</h3>
          <p>えぬを触っておすすめの動画を見よう！(工事中)
          </p>
        </div>
        <div class="work-card">
          <h3>おすすめ動画診断</h3>
          <p>２択でおすすめの動画を！
            （工事中）</p>

        </div>
        <div class="work-card" onclick="location.href='aituber.html'">
          <h3>AItuber</h3>
          <p>藍沢えぬのAITUBERプロジェクトについて</p>
        </div>
      </div>
    </section>


    <section class="model-section">
      <h2>えぬをぐるぐる回してみよう！</h2>
      <div id="model-viewer">
        <div class="loading-text" id="loading-text">モデルを読み込み中...</div>
        <div class="error-text" id="error-text" style="display: none;">
          モデルの読み込みに失敗しました<br>
          モデルファイル(model/aizawa0-2.glb)が存在するか確認してください
        </div>
      </div>
    </section>

  </main>

  <!-- Three.js CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>

  <script>
    console.log('THREE version:', THREE.REVISION);

    const container = document.getElementById('model-viewer');
    const loadingText = document.getElementById('loading-text');
    const errorText = document.getElementById('error-text');

    // シーンの初期化
    const scene = new THREE.Scene();
    scene.background = new THREE.Color(0x1a1a2e);

    // カメラの設定
    const camera = new THREE.PerspectiveCamera(50, container.clientWidth / container.clientHeight, 0.1, 1000);
    camera.position.set(0, 1.4, 3);

    // レンダラーの設定
    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(container.clientWidth, container.clientHeight);
    renderer.shadowMap.enabled = true;
    renderer.shadowMap.type = THREE.PCFSoftShadowMap;
    container.appendChild(renderer.domElement);

    // OrbitControls
    const controls = new THREE.OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;
    controls.dampingFactor = 0.1;
    controls.minDistance = 1;
    controls.maxDistance = 10;

    // ライティング
    const ambientLight = new THREE.AmbientLight(0xffffff, 1.2);
    scene.add(ambientLight);

    const directionalLight = new THREE.DirectionalLight(0xffffff, 1.5);
    directionalLight.position.set(5, 10, 5);
    directionalLight.castShadow = true;
    directionalLight.shadow.mapSize.width = 2048;
    directionalLight.shadow.mapSize.height = 2048;
    scene.add(directionalLight);

    // 追加のライト
    const frontLight = new THREE.DirectionalLight(0xffffff, 1.2);
    frontLight.position.set(0, 1.5, 2);
    scene.add(frontLight);

    // モデル読み込み
    const loader = new THREE.GLTFLoader();

    console.log('モデル読み込み開始: model/aizawa0-2.glb');

    loader.load(
      'model/aizawa0-2.glb',
      function (gltf) {
        console.log('✅ モデル読み込み成功！', gltf);

        const model = gltf.scene;

        // モデルのサイズと位置を調整
        const box = new THREE.Box3().setFromObject(model);
        const center = box.getCenter(new THREE.Vector3());
        const size = box.getSize(new THREE.Vector3());

        console.log('モデル情報:', {
          center: center,
          size: size,
          children: model.children.length
        });

        // モデルを中央に配置
        model.position.sub(center);

        // モデルのスケールを調整
        const maxSize = Math.max(size.x, size.y, size.z);
        if (maxSize > 0) {
          const scaleFactor = 2 / maxSize;
          model.scale.setScalar(scaleFactor);
          console.log(`スケール調整: ${scaleFactor}`);
        }

        // シャドウの設定
        model.traverse(function (child) {
          if (child.isMesh) {
            child.castShadow = true;
            child.receiveShadow = true;
            console.log('メッシュ発見:', child.name || '名前なし');
          }
        });

        scene.add(model);

        // ローディングテキストを隠す
        loadingText.style.display = 'none';

        // 成功メッセージを表示
        const successMsg = document.createElement('div');
        successMsg.style.cssText = `
          position: absolute;
          top: 10px;
          left: 10px;
          background: rgba(76, 175, 80, 0.9);
          color: white;
          padding: 10px;
          border-radius: 5px;
          font-size: 14px;
          z-index: 100;
        `;
        successMsg.textContent = 'モデル読み込み成功！';
        container.appendChild(successMsg);

        // 3秒後にメッセージを削除
        setTimeout(() => {
          if (successMsg.parentNode) {
            successMsg.parentNode.removeChild(successMsg);
          }
        }, 3000);
      },
      function (progress) {
        const percent = (progress.loaded / progress.total * 100).toFixed(1);
        console.log(`読み込み進行中: ${percent}%`);
        loadingText.innerHTML = `モデルを読み込み中... ${percent}%`;
      },
      function (error) {
        console.error('❌ モデル読み込みエラー:', error);
        loadingText.style.display = 'none';
        errorText.style.display = 'block';
      }
    );

    // アニメーションループ
    function animate() {
      requestAnimationFrame(animate);
      controls.update();
      renderer.render(scene, camera);
    }
    animate();

    // ウィンドウリサイズ対応
    window.addEventListener('resize', function () {
      const width = container.clientWidth;
      const height = container.clientHeight;

      camera.aspect = width / height;
      camera.updateProjectionMatrix();

      renderer.setSize(width, height);
    });

    console.log('Scene:', scene);
    console.log('Camera:', camera);
    console.log('Renderer:', renderer);
  </script>






  </main>
</body>

</html>